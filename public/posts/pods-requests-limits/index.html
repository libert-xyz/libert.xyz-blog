<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>
  PODS Requests &amp; Limits · libert.xyz
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">


<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self' https://www.youtube.com; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com https://cdn.jsdelivr.net/; connect-src 'self' https://www.google-analytics.com;">




<meta name="author" content="Libert">
<meta name="description" content="
When creating a pod we can specify the amount of CPU and memory that a container needs.
If a POD has more than one container requests and limits are specified individually for each container.
E.g.

If you don&rsquo;t specify a CPU request the Kubernetes Scheduler will take the decisions of resource allocations for you.
In the worst-case scenario, the container may not get any CPU at all.

  Understanding CPU Units
  
    
    Link to heading
  

The CPU resource is measured in CPU units. One CPU unit in Kubernetes is equivalent to:">
<meta name="keywords" content="blog,devops,libert,aws,python,linux,bash">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="PODS Requests & Limits">
  <meta name="twitter:description" content="When creating a pod we can specify the amount of CPU and memory that a container needs. If a POD has more than one container requests and limits are specified individually for each container.
E.g.
If you don’t specify a CPU request the Kubernetes Scheduler will take the decisions of resource allocations for you. In the worst-case scenario, the container may not get any CPU at all.
Understanding CPU Units Link to heading The CPU resource is measured in CPU units. One CPU unit in Kubernetes is equivalent to:">

<meta property="og:url" content="http://localhost:1313/posts/pods-requests-limits/">
  <meta property="og:site_name" content="libert.xyz">
  <meta property="og:title" content="PODS Requests & Limits">
  <meta property="og:description" content="When creating a pod we can specify the amount of CPU and memory that a container needs. If a POD has more than one container requests and limits are specified individually for each container.
E.g.
If you don’t specify a CPU request the Kubernetes Scheduler will take the decisions of resource allocations for you. In the worst-case scenario, the container may not get any CPU at all.
Understanding CPU Units Link to heading The CPU resource is measured in CPU units. One CPU unit in Kubernetes is equivalent to:">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2019-08-26T13:15:19-04:00">
    <meta property="article:modified_time" content="2019-08-26T13:15:19-04:00">
    <meta property="article:tag" content="Kubernetes">
    <meta property="article:tag" content="Docker">
      <meta property="og:see_also" content="http://localhost:1313/posts/pod-services-pt2/">
      <meta property="og:see_also" content="http://localhost:1313/posts/namespaces-quotas/">
      <meta property="og:see_also" content="http://localhost:1313/posts/pods-qos/">
      <meta property="og:see_also" content="http://localhost:1313/posts/kubernetes-ha/">
      <meta property="og:see_also" content="http://localhost:1313/posts/pod-services/">
      <meta property="og:see_also" content="http://localhost:1313/posts/pod-networking/">
      <meta property="og:see_also" content="http://localhost:1313/posts/namespaces-quotas/">
      <meta property="og:see_also" content="http://localhost:1313/posts/pods-qos/">




<link rel="canonical" href="http://localhost:1313/posts/pods-requests-limits/">


<link rel="preload" href="http://localhost:1313/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="http://localhost:1313/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="http://localhost:1313/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="http://localhost:1313/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="http://localhost:1313/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="http://localhost:1313/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="http://localhost:1313/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="http://localhost:1313/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="http://localhost:1313/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1313/images/apple-touch-icon.png">

<link rel="manifest" href="http://localhost:1313/site.webmanifest">
<link rel="mask-icon" href="http://localhost:1313/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:1313/">
      libert.xyz
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="http://localhost:1313/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="http://localhost:1313/open-source/">Open Source Projects</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="http://localhost:1313/about/">About</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="http://localhost:1313/posts/pods-requests-limits/">
              PODS Requests &amp; Limits
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2019-08-26T13:15:19-04:00">
                August 26, 2019
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              3-minute read
            </span>
          </div>
          
          
          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="http://localhost:1313/tags/kubernetes/">Kubernetes</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="http://localhost:1313/tags/docker/">Docker</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <hr>
<p>When creating a pod we can specify the amount of CPU and memory that a container needs.
If a POD has more than one container requests and limits are specified individually for each container.</p>
<p><strong>E.g.</strong></p>
<p><img src="http://localhost:1313/images/1req.png" alt="targets"></p>
<p>If you don&rsquo;t specify a CPU request the Kubernetes Scheduler will take the decisions of resource allocations for you.
In the worst-case scenario, the container may not get any CPU at all.</p>
<h3 id="understanding-cpu-units">
  Understanding CPU Units
  <a class="heading-link" href="#understanding-cpu-units">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>The CPU resource is measured in CPU units. One CPU unit in Kubernetes is equivalent to:</p>
<ul>
<li>1 AWS vCPU</li>
<li>1 GCP Core</li>
<li>1 Azure vCore</li>
</ul>
<p>You can use the suffix m that means <strong>millicores</strong>.</p>
<p><strong>E.g.</strong></p>
<p>100m CPU = 0.1 CPU
500m CPU = 0.5 CPU</p>
<h3 id="requests-and-scheduling">
  Requests and Scheduling
  <a class="heading-link" href="#requests-and-scheduling">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>The request resource specifies the <strong>minimum amount</strong> of resources that the pod needs. The <em>Scheduler</em> uses this information when scheduling the pod to a node.
When scheduling a pod, the <em>Scheduler</em> will only consider nodes with enough unallocated resources to meet the request resource.</p>
<h3 id="how-does-the-scheduler-decide-if-a-pod-fits-in-a-node">
  How does the Scheduler decide if a POD fits in a Node?
  <a class="heading-link" href="#how-does-the-scheduler-decide-if-a-pod-fits-in-a-node">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Here is when it gets a bit confusing because the <em>Scheduler</em> doesn&rsquo;t look how much resources are being used at the time of scheduling but the <strong>sum</strong> of resources requested by existing pods deployed in the node.
In summary, the Scheduler only cares about requests, not actual usage.</p>
<p><strong>E.g.</strong></p>
<p><img src="http://localhost:1313/images/2req.png" alt="targets"></p>
<h3 id="resource-limits">
  Resource Limits
  <a class="heading-link" href="#resource-limits">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ul>
<li>
<p><strong>Requests</strong> ensure that the container gets the <strong>minimum</strong> amount of resources it needs.</p>
</li>
<li>
<p><strong>Limits</strong> ensure the <strong>maximum</strong> amount of resources the container will be allowed to consume.</p>
</li>
</ul>
<p>CPU is a compressible resource, which means the amount used by a container can
be throttled without affecting the process running in the container.
On the other hand, Memory is incompressible. Once a process is given a chunk of
memory, that memory can’t be taken away from it until it’s released by the process
itself.
That’s why we need to limit the maximum amount of memory a container can
be given.</p>
<p>Without limiting memory, a container/pod running on a worker node may
eat up all the available memory and affect all other pods on the node and any new
pods scheduled to the node. A single malfunction-
ing or malicious pod can practically make the whole node unusable.</p>
<p><strong>E.g.</strong></p>
<p><img src="https://libert.xyz/images/3req.png" alt="k8-p2-3" title="Limits"></p>
<p>In the example above you can see that we haven&rsquo;t specified Requests, in that case, request is set to the same values as limits.</p>
<h3 id="reaching-the-limit">
  Reaching the limit
  <a class="heading-link" href="#reaching-the-limit">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Unlike <em>requests</em>, the <strong>sum</strong> of all the limits are <strong>allowed</strong> to exceed 100% of the node capacity. The consequence of this is when 100% of the node&rsquo;s resources are used some containers will need to be killed.</p>
<p><strong>E.g.</strong></p>
<p><img src="https://libert.xyz/images/4req.png" alt="k8-p2-4" title="Limits2"></p>
<h3 id="oomkilledout-of-memory">
  OOMKilled/Out of Memory
  <a class="heading-link" href="#oomkilledout-of-memory">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>CPU use is <strong>throttled</strong> when reaching the limits. Is not the same case with memory, the process is killed when tries to allocate memory out of the limit (OOMKilled).</p>
<h3 id="containers-always-see-the-nodes-memory-and-cpu-not-the-containers">
  Containers always see the node&rsquo;s memory and CPU, not the container&rsquo;s
  <a class="heading-link" href="#containers-always-see-the-nodes-memory-and-cpu-not-the-containers">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Even if we set the limit on how much memory is available to a container, the container is not aware of this limit.
This has a negative effect on any application that looks up the amount of memory available on the system and uses that information to decide how much memory to use.</p>
<p>Sources:</p>
<p><a href="https://www.manning.com/books/kubernetes-in-action"  class="external-link" target="_blank" rel="noopener">https://www.manning.com/books/kubernetes-in-action</a></p>
<hr>

      </div>


      <footer>
        

<section class="see-also">
  
    
    
    
      <h3 id="see-also-in-kubernetes">
        See also in kubernetes
        <a class="heading-link" href="#see-also-in-kubernetes">
          <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
          <span class="sr-only">Link to heading</span>
        </a>
      </h3>
      <nav>
        <ul>
        
        
          
            <li>
              <a href="http://localhost:1313/posts/pod-services-pt2/">Kubernetes Services insights Pt2</a>
            </li>
          
        
          
            <li>
              <a href="http://localhost:1313/posts/namespaces-quotas/">Namespaces resources quotas</a>
            </li>
          
        
          
            <li>
              <a href="http://localhost:1313/posts/pods-qos/">PODS QoS</a>
            </li>
          
        
          
        
          
            <li>
              <a href="http://localhost:1313/posts/kubernetes-ha/">Highly Available Kubernetes Cluster</a>
            </li>
          
        
          
            <li>
              <a href="http://localhost:1313/posts/pod-services/">Kubernetes Services insights</a>
            </li>
          
        
        </ul>
      </nav>
    
  
    
    
    
      <h3 id="see-also-in-qos">
        See also in QoS
        <a class="heading-link" href="#see-also-in-qos">
          <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
          <span class="sr-only">Link to heading</span>
        </a>
      </h3>
      <nav>
        <ul>
        
        
          
            <li>
              <a href="http://localhost:1313/posts/namespaces-quotas/">Namespaces resources quotas</a>
            </li>
          
        
          
            <li>
              <a href="http://localhost:1313/posts/pods-qos/">PODS QoS</a>
            </li>
          
        
          
        
        </ul>
      </nav>
    
  
</section>


        
        
        
        
        
        
        
      </footer>
    </article>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
    integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"
    integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body,
      {
        delimiters: [
          {left: '$$', right: '$$', display:true},
          {left: '$', right: '$', display:false},
          {left: '\\(', right: '\\)', display: false},
          {left: '\\[', right: '\\]', display: true}
        ]
      }
    );"></script>
  </section>

    </div>

  </main>

  

  
  
  <script src="http://localhost:1313/js/coder.js"></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
